{
	%end = sched {print(this['array])}(this)
	
	this['index] = 0
	this['array] = new array
	this['future] = %end
	
	%loop = sched :loop(this)
	%loop -> %end
}

loop: {
	%index = this['index]
	%test = geq(%index, 42)
	%body = branch(%test, :false, this, :true, this)
	%body -> this['future]
}

false: {
	%arr = this['array]
	%index = this['index]
	%index = inc(%index)
	%arr[%index] = 'end
	;fall through to future
}

true: {
	%arr = this['array]
	%index = this['index]
	%index = inc(%index)
	this['index] = %index
	
	%elem = new struct
	%elem['id] = %index
	%arr[%index] = %elem
	
	%next = sched :loop(this)
	%next -> this['future]
}